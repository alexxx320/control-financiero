  /**
   * Actualizar saldo del fondo cuando hay transacciones
   */
  async actualizarSaldo(fondoId: string, tipo: 'ingreso' | 'gasto', monto: number, usuarioId: string): Promise<Fondo> {
    console.log(`ðŸ’° Actualizando saldo - Fondo: ${fondoId}, Tipo: ${tipo}, Monto: ${monto}`);
    
    const fondo = await this.findOne(fondoId, usuarioId);
    console.log(`ðŸ“Š Saldo actual del fondo "${fondo.nombre}": ${fondo.saldoActual}`);
    
    const nuevoSaldo = tipo === 'ingreso' 
      ? fondo.saldoActual + monto
      : fondo.saldoActual - monto;
    
    console.log(`ðŸ”„ Calculando nuevo saldo: ${fondo.saldoActual} ${tipo === 'ingreso' ? '+' : '-'} ${monto} = ${nuevoSaldo}`);
    
    // Permitir saldos negativos pero registrar la situaciÃ³n
    if (nuevoSaldo < 0) {
      console.warn(`âš ï¸ Saldo negativo en fondo "${fondo.nombre}": ${nuevoSaldo}`);
    }
    
    const fondoActualizado = await this.fondoModel
      .findOneAndUpdate(
        { _id: fondoId, usuarioId: new Types.ObjectId(usuarioId) },
        { saldoActual: nuevoSaldo },
        { new: true }
      )
      .exec();

    if (!fondoActualizado) {
      throw new NotFoundException(`No se pudo actualizar el saldo del fondo con ID "${fondoId}"`);
    }
    
    console.log(`âœ… Saldo actualizado exitosamente: ${fondo.saldoActual} â†’ ${fondoActualizado.saldoActual}`);
    
    return fondoActualizado;
  }